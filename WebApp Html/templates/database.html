<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="generator" content="Hugo 0.58.2" />
    <title>PennState Plates</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="https://cdn.simplecss.org/simple.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">

    <link rel="alternate" type="application/rss+xml" href="https://pennstateplates.com/index.xml" title="PennState Plates">
    <link rel="authorization_endpoint" href="https://indieauth.com/auth">
    <link rel="token_endpoint" href="https://tokens.indieauth.com/token">
    <link rel="microsub" href="https://aperture.p3k.io/microsub/205">
</head>
<body>
    <header>
        <h1>$ ‚ùØ PennState Plates</h1>
        <div class="site-description">Simplifying the parking permit process.</div>
        <nav class="main-nav">
            <ul>
                <li><a class="nav-button" href="{{ url_for('home') }}">Home</a></li>
                <li><a class="nav-button" href="{{ url_for('about') }}">About</a></li>
                <li><a class="nav-button" href="{{ url_for('database') }}">Database</a></li>
                <li><a class="nav-button" href="{{ url_for('changelog') }}">Changelog</a></li>
                {% if session.logged_in %}
                <li><a class="nav-button" href="{{ url_for('logout') }}">Logout</a></li>
                {% else %}
                <li><a class="nav-button" href="{{ url_for('login') }}">Login</a></li>
                {% endif %}
            </ul>
        </nav>
    </header>

<main>
    <article class="h-entry content-box">
        <h2>Database</h2>
        <div class="toggle-switch-container" style="text-align: center;">
            <label class="switch">
                <input type="checkbox" id="viewToggle" onchange="toggleView()">
                <span class="slider round"></span>
            </label>

        </div>
        <div class="centered-table-container">
        <table class="database-table">
            <thead>
                <tr>
                    <th>IDNum</th>
                    <th>Name</th>
                    <th>PlateNum</th>
                    <th>PlateState</th>
                    <th>Vehicle-Make</th>
                    <th>Vehicle-Model</th>
                    <th>PersonType</th>
                    <th>Email</th>
                </tr>
            </thead>
            <tbody>
                {% for row in data %}
                <tr>
                    <td>{{row[0]}}</td>
                    <td>{{row[1]}}</td>
                    <td>{{row[2]}}</td>
                    <td>{{row[3]}}</td>
                    <td>{{row[4]}}</td>
                    <td>{{row[5]}}</td>
                    <td>{{row[6]}}</td>
                    <td>{{row[7]}}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        </div>
       {% if is_admin %}
<div class="form-toggle-buttons">
    <button type="button" onclick="toggleForm('addForm')">Add Registration</button>
    <button type="button" onclick="toggleForm('removeForm')">Remove Registration</button>
    <button type="button" onclick="toggleForm('searchForm')">Search</button>
</div>

        <div class="add-register-form" id="addForm" style="display:none;">
            <h3>Add User to Register</h3>
            <form method="POST" action="{{ url_for('register') }}">

                <label for="idNum">ID#:</label>
                <input type="text" id="idNum" name="ID#" placeholder="12345" required>

                <label for="name">Name:</label>
        <input type="text" id="name" name="Name" placeholder="John Doe" required>

        <label for="plateNum">Plate#:</label>
        <input type="text" id="plateNum" name="Plate#" placeholder="ABC1354" required>

        <label for="state">State:</label>
        <input type="text" id="state" name="State" placeholder="Pennsylvania" required>

        <label for="make">Vehicle Make:</label>
        <input type="text" id="make" name="Make" placeholder="Toyota" required>

        <label for="model">Vehicle Model:</label>
        <input type="text" id="model" name="Model" placeholder="Camry" required>

        <label for="personType">Person Type:</label>
        <input type="text" id="personType" name="PersonType" placeholder="Student" required>

        <label for="email">Email:</label>
        <input type="email" id="email" name="Email" placeholder="abc@psu.edu" required>

        <input type="submit" value="Add to Register">
            </form>
        </div>
        <div id="removeForm" style="display:none;">
    <!-- Remove Register Form -->
    <h3>Remove User from Register</h3>
    <form method="POST" action="{{ url_for('delete_register') }}">
        <div class="m-2">
            <label for="idNumDelete">ID#:</label>
            <input type="text" id="idNumDelete" name="ID#" placeholder="Enter ID to remove" required>
        </div>
        <div class="m-2">
            <label for="plateNumDelete">Plate#:</label>
            <input type="text" id="plateNumDelete" name="Plate#" placeholder="ABC1354" required>
        </div>
        <div class="m-2">
            <label for="stateDelete">State:</label>
            <input type="text" id="stateDelete" name="State" placeholder="Pennsylvania" required>
        </div>
        <button type="submit" class="btn btn-secondary">Remove from Register</button>
    </form>
            </div>
<div id="searchForm" style="display:none;">
    <h3>Search Database</h3>
    <form method="GET" action="{{ url_for('search') }}">
        <div class="m-2">
            <label for="searchName">Name:</label>
            <input type="text" id="searchName" name="name" placeholder="Enter name">
        </div>
        <div class="m-2">
            <label for="searchDate">Registration Start Date:</label>
            <input type="date" id="searchDate" name="date">
        </div>
        <div class="m-2">
            <label for="searchState">Plate State:</label>
            <input type="text" id="searchState" name="state" placeholder="Enter state">
        </div>
        <div class="m-2">
            <label for="searchPlate">Plate Number:</label>
            <input type="text" id="searchPlate" name="plate" placeholder="Enter plate number">
        </div>
        <button type="submit" class="btn btn-secondary">Search</button>
    </form>
</div>



        {% endif %}
    </article>
</main>


    <footer>
        &copy; {{ current_year }} PennState Plates.
    </footer>

<script>
function getCurrentView() {
    // Check if 'view' parameter is present in the URL
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get('view') || 'registered'; // Default to 'registered' if not specified
}

function toggleView() {
    const currentView = getCurrentView();
    const newView = (currentView === 'unregistered') ? 'registered' : 'unregistered';
    // Redirect to the new URL with the updated view parameter
    window.location.href = window.location.origin + window.location.pathname + '?view=' + newView;
}


function hideAllForms() {
    document.getElementById('addForm').style.display = 'none';
    document.getElementById('removeForm').style.display = 'none';
    document.getElementById('searchForm').style.display = 'none';
}

function toggleForm(formId) {
    hideAllForms();
    document.getElementById(formId).style.display = 'block';
}

window.onload = function() {
    // Check the current view and set the toggle state accordingly
    const currentView = getCurrentView();
    document.getElementById('viewToggle').checked = (currentView === 'unregistered');

    // Hide all forms initially and then show the relevant form based on the flash message
    hideAllForms();
    var message = "{{ get_flashed_messages() }}";
    if (message.includes('add')) {
        toggleForm('addForm');
    } else if (message.includes('delete')) {
        toggleForm('removeForm');
    } else if (message.includes('search')) {
        toggleForm('searchForm');
    }
};

</script>


</body>
</html>
